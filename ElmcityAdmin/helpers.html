<html>
<head>
<title> the elmcity project: iCalendar helpers </title>
<style>

body {
font-family:verdana;
margin-left:1in;
margin-right:.5in;
}

h1 {
margin-top:.25in;
text-align:center;
font-size:18pt;
}

h2 {
font-size:16pt;
margin-top:.25in;
}

h3 {
font-size:13pt;
margin-top:.25in;
}

a:link, a:visited {
    color: #000000;
}
a:hover {
    background-color: #F4F2E4;
    color: #555555;
}

</style>

<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js"></script>

<script>

function ec_id()
{
alert("Your Elm City ID is the ID of your hub. For example: BostonMA, CTNEXT, seattleopencalendar");
}

function get_nasa_iss_ical_url()
{
var nasa_elmcity_id = $('#nasa_id').val();
var nasa_country = $('#nasa_country').val();
var nasa_state_region = $('#nasa_state_region').val();
var nasa_city = $('#nasa_city').val();

var ical_url = 'http://elmcity.cloudapp.net/ics_from_nasa_iss_tracking_rss' +
                '?elmcity_id=' + nasa_elmcity_id +
                '&amp;country=' + nasa_country + 
                '&amp;state_region=' + nasa_state_region + 
                '&amp;city=' + nasa_city;
$('#nasa_url').html(ical_url);
}


function get_form_post_ical_url()
{
var fp_feed_url = $('#fp_feed_url').val();
fp_feed_url = encodeURIComponent(fp_feed_url);
var ical_url = 'http://elmcity.cloudapp.net/get_form_post_ical_url' +
                '?fp_feed_url=' +
                fp_feed_url;
location.href = ical_url;
}

function get_fb_ical_url()
{
var fb_page_url = $('#fb_page_url').val();
fb_page_url = encodeURIComponent(fb_page_url);
var elmcity_id = $('#fb_elmcity_id').val();
var ical_url = 'http://elmcity.cloudapp.net/get_fb_ical_url' +
                '?fb_page_url=' +
                fb_page_url +
                '&elmcity_id=' +
                elmcity_id;
location.href = ical_url;
}

function get_eb_eid_ical_url()
{
var eb_page_url = $('#eb_eid_page_url').val();
eb_page_url = encodeURIComponent(eb_page_url);
var elmcity_id   = $('#eb_eid_id').val();
var ical_url = 'http://elmcity.cloudapp.net/get_ical_url_from_eid_of_eventbrite_event_page' +
                '?url=' +
                eb_page_url +
                '&elmcity_id=' +
                elmcity_id;
location.href = ical_url;
}


function get_eb_ical_url()
{
var eb_page_url = $('#eb_page_url').val();
eb_page_url = encodeURIComponent(eb_page_url);
var elmcity_id = $('#eb_organizer_id').val();
var ical_url = 'http://elmcity.cloudapp.net/get_ical_url_from_eventbrite_event_page' +
                '?url=' +
                eb_page_url +
                '&elmcity_id=' +
                elmcity_id;
location.href = ical_url;
}


function get_hs_ical_url()
{
var hs_school = $('#hs_school').val();
var hs_tz = $('#hs_tz').val();
var ical_url = 'http://elmcity.cloudapp.net/get_high_school_sports_url/' + 
                hs_school + 
				'/' + 
                hs_tz;
location.href = ical_url;
}

function get_csv_ical_url()
{
var csv_feed_url   = $('#csv_feed_url').val();
var csv_home_url   = $('#csv_home_url').val();
var csv_skip_first = $('#csv_skip_first option:selected').text();
var csv_title_col  = $('#csv_title_col').val();
var csv_date_col   = $('#csv_date_col').val();
var csv_time_col   = $('#csv_time_col').val();
var csv_tz         = $('#csv_tz option:selected').text();

var ical_url = 'http://elmcity.cloudapp.net/get_csv_ical_url' +
                '?feed_url=' +
                encodeURIComponent(csv_feed_url) +
                '&home_url=' +
                encodeURIComponent(csv_home_url) +
                '&skip_first_row=' +
                csv_skip_first +
                '&title_col=' +
                csv_title_col +
                '&date_col=' +
                csv_date_col +
                '&time_col=' +
                csv_time_col +
                '&tzname=' +
                csv_tz;

location.href = ical_url;
}

// string feedurl, string elmcity_id, string source, string after, string before, string include_keyword, string exclude_keyword, string summary_only, string description_only, string url_only, string location_only

var ics_template = 'http://elmcity.cloudapp.net/ics_from_ics?feedurl=&elmcity_id=&source=&after=&before=&include_keyword=&exclude_keyword=&summary_only=&description_only=&url_only=&location_only=';


function get_ics_to_ics_ical_url_1()
{
var filter_feed_url   = $('#filter_feed_url').val();
var include_keyword   = $('#filter_include_keyword').val();
var elmcity_id        = $('#filter_elmcity_id').val();

var ical_url = ics_template.replace('feedurl=','feedurl=' + filter_feed_url);
ical_url = ical_url.replace('elmcity_id=','elmcity_id=' + elmcity_id);
ical_url = ical_url.replace('include_keyword=', 'include_keyword=' + include_keyword);

$('#ics_to_ics_ical_url_1').html('<p>' + ical_url + '</p>');

}

function get_ics_to_ics_ical_url_2()
{
var filter_feed_url   = $('#filter_feed_url2').val();
var filter_after      = $('#filter_after').val();
var elmcity_id        = $('#filter_elmcity_id').val();

var ical_url = ics_template.replace('feedurl=','feedurl=' + filter_feed_url);
ical_url = ical_url.replace('elmcity_id=','elmcity_id=' + elmcity_id);
ical_url = ical_url.replace('after=', 'after=' + filter_after);

$('#ics_to_ics_ical_url_2').html(ical_url);

}

function get_ics_to_ics_ical_url_3()
{
var filter_feed_url   = $('#bampfa_feed_url').val();
var url_keyword       = $('#url_include').val();
var elmcity_id        = $('#bampfa_elmcity_id').val();

var ical_url = ics_template.replace('feedurl=','feedurl=' + filter_feed_url);
ical_url = ical_url.replace('elmcity_id=','elmcity_id=' + elmcity_id);
ical_url = ical_url.replace('include_keyword', 'include_keyword=' + url_keyword);
ical_url = ical_url.replace('url_only=', 'url_only=yes');

$('#ics_to_ics_ical_url_3').html(ical_url);

}

function get_ics_to_ics_ical_url_4()
{
var filter_feed_url   = $('#trinity_feed_url_away').val();
var include_keyword       = $('#location_include_away').val();
var elmcity_id        = $('#hartford_elmcity_id_away').val();

var ical_url = ics_template.replace('feedurl=','feedurl=' + filter_feed_url);
ical_url = ical_url.replace('elmcity_id=','elmcity_id=' + elmcity_id);
ical_url = ical_url.replace('include_keyword=', 'include_keyword=' + include_keyword);
ical_url = ical_url.replace('location_only=', 'location_only=yes');

$('#ics_to_ics_ical_url_4').html(ical_url);
}

function get_ics_to_ics_ical_url_5()
{
var filter_feed_url   = $('#trinity_feed_url_away').val();
var exclude_keyword       = $('#location_exclude_away').val();
var elmcity_id        = $('#hartford_elmcity_id_home').val();

var ical_url = ics_template.replace('feedurl=','feedurl=' + filter_feed_url);
ical_url = ical_url.replace('elmcity_id=','elmcity_id=' + elmcity_id);
ical_url = ical_url.replace('exclude_keyword=', 'exclude_keyword=' + exclude_keyword);
ical_url = ical_url.replace('location_only=', 'location_only=yes');

$('#ics_to_ics_ical_url_5').html(ical_url);

}


function get_ics_to_ics_ical_url_6()
{
var filter_feed_url   = $('#crazy_wisdom_feed_url').val();
var include_keyword       = $('#include_crazywisdom').val();
var elmcity_id        = $('#crazy_wisdom_elmcity_id').val();

var ical_url = ics_template.replace('feedurl=','feedurl=' + filter_feed_url);
ical_url = ical_url.replace('elmcity_id=','elmcity_id=' + elmcity_id);
ical_url = ical_url.replace('include_keyword=', 'include_keyword=' + include_keyword);
ical_url = ical_url.replace('summary_only=', 'summary_only=yes');

$('#ics_to_ics_ical_url_6').html(ical_url);

}


function get_ics_to_ics_ical_url_7()
{
var filter_feed_url   = $('#lets_dance_feed_url').val();
var exclude_keyword       = $('#exclude_lets_dance').val();
var elmcity_id        = $('#lets_dance_elmcity_id').val();

var ical_url = ics_template.replace('feedurl=','feedurl=' + filter_feed_url);
ical_url = ical_url.replace('elmcity_id=','elmcity_id=' + elmcity_id);
ical_url = ical_url.replace('exclude_keyword=', 'exclude_keyword=' + exclude_keyword);
ical_url = ical_url.replace('summary_only=', 'summary_only=yes');

$('#ics_to_ics_ical_url_7').html(ical_url);

}



function get_rss_xcal_ical_url()
{
var rss_xcal_feed_url   = $('#rss_xcal_feed_url').val();
var rss_id              = $('#rss_id').val();

var ical_url = 'http://elmcity.cloudapp.net/get_rss_xcal_ical_url' +
                '?feedurl=' +
                encodeURIComponent(rss_xcal_feed_url) +
                '&elmcity_id=' +
                rss_id;

location.href = ical_url;
}

function view_feed()
{
var feedurl =  $('#feedviewer_url').val();
var property = $('#feedviewer_property').val();
var url = 'http://elmcity.cloudapp.net/text_from_ics' +
                '?url=' +
                encodeURIComponent(feedurl) +
                '&property=' +
                property;

location.href = url;
}

function view_feed_html()
{
var feedurl =  $('#calviewer_url').val();
var id = $('#calviewer_id').val();
var url = 'http://elmcity.cloudapp.net/view_calendar' +
                '?feedurl=' +
                encodeURIComponent(feedurl) +
                '&id=' +
                id;

location.href = url;
}

 
String.prototype.contains = function (str){
    return this.indexOf(str) != -1;
};



</script>


</head>

<body>

<p style="text-align:center">
<a href="#bookmarklets">bookmarklets</a> &#149; 
<a href="#urlbuilders">iCalendar URL builders</a> &#149; 
<a href="#filters">iCalendar filters</a> &#149; 
<a href="#viewers">feed viewers</a>

</p>

<a name="bookmarklets">
<h1>bookmarklets</h1>

<a name="gcal"></a>
<h2>Google Calendar</h2>

<p>
This bookmarklet extracts the iCalendar URL from a web page on which an instance of Google Calendar has been embedded. An example of such a page: the <a href="http://www.mariposamuseum.org/calendar.html">Mariposa Museum Calendar</a>.
</p>
<p>
Here is the bookmarklet: <a href="javascript:(function(){document.head.appendChild(document.createElement('script')).src='http://elmcity.blob.core.windows.net/admin/get-ical-from-gcal.js';})()">get ical from gcal</a>. To install it, drag the link to your browser's links toolbar. To use it, visit a page like the Mariposa Museum Calendar and click the link. The bookmarklet will figure out the iCalendar URL and report it at the top of the page.
</p>


<a name="urlbuilders">
<h1>iCalendar URL builders</h1>

<a name="facebook"></a>
<h2>Facebook Pages</h2>

<p>
Some Facebook pages, like <a href="https://www.facebook.com/BerkeleyUndergroundFilmSociety?sk=events">Berkeley Underground Film Society</a>, include calendars.
</p>
<p>
This helper accepts the URL of a Facebook page and an <a href="javascript:ec_id()">Elm City ID</a>. It produces a corresponding iCalendar feed URL that you can add to your hub's registry.
</p>

<table>

<tr>
<td style="text-align:right">Facebook Page: </td>
<td><input style="width:4in" id="fb_page_url" value="https://www.facebook.com/BerkeleyUndergroundFilmSociety"></td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="fb_elmcity_id" value="berkeley"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_fb_ical_url()"></td>
<td></td>
</tr>


</table>

<p style="font-size:smaller">
Note: This now works both for Facebook fan pages as shown above, and also for group pages with calendars such as https://www.facebook.com/groups/Bytemarks.Meetup.
</p>


<a name="eventbrite_page"></a>
<h2>EventBrite Page</h2>

<p>
This helper accepts the URL of an EventBrite event page and an <a href="javascript:ec_id()">Elm City ID</a>. It finds the EventBrite ID for the event, synthesizes an iCalendar feed for that event, and produces an iCalendar feed URL that you can add to your hub's registry.
</p>

<table>

<tr>
<td style="text-align:right">EventBrite Page: </td>
<td><input style="width:4in" id="eb_eid_page_url" value="http://citycampral.eventbrite.com/"></td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="eb_eid_id" value="BostonMA"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_eb_eid_ical_url()"></td>
<td></td>
</tr>


</table>

<a name="eventbrite"></a>

<h2>EventBrite Organizer</h2>

<p>
This helper accepts the URL of an EventBrite event page and an <a href="javascript:ec_id()">Elm City ID</a>. It finds the organizer for the event, synthesizes an iCalendar feed for that organizer's events, and produces a iCalendar feed URL that you can add to your hub's registry.
</p>

<table>

<tr>
<td style="text-align:right">EventBrite Page: </td>
<td><input style="width:4in" id="eb_page_url" value="http://webinno33.eventbrite.com/"></td>
</tr>


<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="eb_organizer_id" value="BostonMA"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_eb_ical_url()"></td>
<td></td>
</tr>


</table>

<a name="nasa_iss"></a>

<h2>NASA Space Station Tracker</h2>

<p>
On NASA's <a href="http://spotthestation.nasa.gov/sightings/index.cfm">Spot the Station</a> page you can find the schedule for upcoming sightings of the space station in your location. There is only an RSS feed, not an iCalendar feed, but you can construct an iCalendar feed here. Find your closest city on the NASA page, it will produce an URL like this:
</p>

<p>
http://spotthestation.nasa.gov/sightings/view.cfm?country=<b>United_States</b>&amp;region=<b>New_Hampshire</b>&city=<b>Dublin</b>
</p>

<p>
Transfer the values for country, region, and city (exactly as shown in the generated URL) to this form.
</p>

<table>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="nasa_id" value="DublinNH"></td>
</tr>

<tr>
<td style="text-align:right">Country: </td>
<td><input style="width:1.5in" id="nasa_country" value="United_States"></td>
</tr>

<tr>
<td style="text-align:right">State or Region: </td>
<td><input style="width:1.5in" id="nasa_state_region" value="New_Hampshire"></td>
</tr>

<tr>
<td style="text-align:right">City: </td>
<td><input style="width:1.5in" id="nasa_city" value="Dublin"></td>
</tr>


<tr>
<td><input type="submit" value="get ical url" onclick="get_nasa_iss_ical_url()"></td>
<td></td>
</tr>


</table>

<p id="nasa_url"></p>


<a name="form_post"></a>

<h2>POST instead of GET</h2>

<p>
Some sites, like <a href="http://www.jewishmother.com/VB/calender">The Jewish Mother</a> in Virginia Beach, offer feeds that require the Elm City service to use an HTTP POST request rather than an HTTP GET request. This helper accepts an URL formulated like a GET request, and produces an URL that will fetch the feed by POSTing the corresponding form.
</p>

<table>

<tr>
<td style="text-align:right">Feed URL, GET-style: </td>

<td><input style="width:8in" id="fp_feed_url" value="http://www.jewishmother.com/VB/content/calendar/calendar_download.php?from_calendar=1&from_category=&downloadType=2&calendar_criteria=1&category_criteria=0&fromdatemonth_criteria=1&fromdateday_criteria=1&fromdateyear_criteria=2013&todatemonth_criteria=7&todateday_criteria=21&todateyear_criteria=2020"></td>
</tr>


<tr>
<td><input type="submit" value="get ical url" onclick="get_form_post_ical_url()"></td>
<td></td>
</tr>


</table>



<a name="csv"></a>
<h2>CSV (comma-separated values) format</h2>

<p>
Some sites, like Rice University Athletics, provide calendar data <a href="http://www.riceowls.com/ot/rice-sched-download.html">only as CSV files</a>. This helper accepts these inputs:
</p>
<ol>
<li>The URL of the CSV file</li>
<li>The URL that events found in that file will link back to</li>
<li>Whether to skip the first row of the file (because it contains fieldnames not data)</li>
<li>The zero-based column number of the event title</li>
<li>The zero-based column number of the date</li>
<li>The zero-based column number of the time</li>
<li>The timezone</li>
</ol>

<p>
It produces the iCalendar feed URL corresponding to the CSV data.
</p>

<table>

<tr>
<td style="text-align:right">CSV URL: </td>
<td><input style="width:5in" id="csv_feed_url" value="http://grfx.cstv.com/schools/rice/graphics/csv/12-rice-m-baskbl-cac.csv"></td>
</tr>

<tr>
<td style="text-align:right">Home URL: </td>
<td><input style="width:5in" id="csv_home_url" value="http://www.riceowls.com/calendar/events/"></td>
</tr>

<tr>
<td style="text-align:right">Skip first row: </td>
<td>
<select id="csv_skip_first">
<option selected>yes</option>
<option>no</option>
</select>
</td>
</tr>

<tr>
<td style="text-align:right">Title column: </td>
<td><input style="width:.5in" id="csv_title_col" value="0"></td></td>
</tr>

<tr>
<td style="text-align:right">Date column: </td>
<td><input style="width:.5in" id="csv_date_col" value="1"></td></td>
</tr>

<tr>
<td style="text-align:right">Time column: </td>
<td><input style="width:.5in" id="csv_time_col" value="2"></td></td>
</tr>

<tr>
<td style="text-align:right">Timezone: </td>
<td>
<select id="csv_tz">
<option>afghanistan</option>
<option>alaskan</option>
<option>arab</option>
<option>arabian</option>
<option>arabic</option>
<option>argentina</option>
<option>atlantic</option>
<option>aus+central</option>
<option>aus+eastern</option>
<option>azerbaijan</option>
<option>azores</option>
<option>canada+central</option>
<option>cape+verde</option>
<option>caucasus</option>
<option>cen.+australia</option>
<option>central+america</option>
<option>central+asia</option>
<option>central+brazilian</option>
<option>central+europe</option>
<option>central+european</option>
<option>central+pacific</option>
<option>central</option>
<option>central+(mexico)</option>
<option>china</option>
<option>dateline</option>
<option>e.+africa</option>
<option>e.+australia</option>
<option>e.+europe</option>
<option>e.+south+america</option>
<option selected>eastern</option>
<option>egypt</option>
<option>ekaterinburg</option>
<option>fiji</option>
<option>fle</option>
<option>georgian</option>
<option>gmt</option>
<option>greenland</option>
<option>greenwich</option>
<option>gtb</option>
<option>hawaiian</option>
<option>india</option>
<option>iran</option>
<option>israel</option>
<option>jordan</option>
<option>korea</option>
<option>mauritius</option>
<option>mid-atlantic</option>
<option>middle+east</option>
<option>montevideo</option>
<option>morocco</option>
<option>mountain</option>
<option>mountain+(mexico)</option>
<option>myanmar</option>
<option>n.+central+asia</option>
<option>namibia</option>
<option>nepal</option>
<option>new+zealand</option>
<option>newfoundland</option>
<option>north+asia+east</option>
<option>north+asia</option>
<option>pacific+sa</option>
<option>pacific</option>
<option>pacific+(mexico)</option>
<option>pakistan</option>
<option>romance</option>
<option>russian</option>
<option>sa+eastern</option>
<option>sa+pacific</option>
<option>sa+western</option>
<option>samoa</option>
<option>se+asia</option>
<option>singapore</option>
<option>south+africa</option>
<option>sri+lanka</option>
<option>taipei</option>
<option>tasmania</option>
<option>tokyo</option>
<option>tonga</option>
<option>us+eastern</option>
<option>us+mountain</option>
<option>venezuela</option>
<option>vladivostok</option>
<option>w.+australia</option>
<option>w.+central+africa</option>
<option>w.+europe</option>
<option>west+asia</option>
<option>west+pacific</option>
</select>
</td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_csv_ical_url()"></td>
<td></td>
</tr>

</table>


<a name="rss_xcal"></a>
<h2>RSS with xCal (e.g. Zvents)</h2>

<p>
Although many sites provide RSS feeds for their calendars, most of these feeds don't format the calendar information in a way that enables automated data exchange. One notable exception is Zvents, a service used by a number of newspapers including <a href="http://www.seattlepi.com/">SeattlePI</a>.
</p>

<p>
The <a href="http://events.seattlepi.com/search?cat=1&st=event">Arts & Crafts category at SeattlePI.com</a> is an example of such a feed. Here's how the elmcity project's Seattle hub transforms that RSS feed into an iCalendar feed:
</p>

<table>

<tr>
<td style="text-align:right">RSS feed: </td>
<td><input style="width:6in" id="rss_xcal_feed_url" value="http://events.seattlepi.com/search?cat=1&new=n&rss=1&srad=10&st=event&svt=text"></td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="rss_id" value="seattleopencalendar"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_rss_xcal_ical_url()"></td>
<td></td>
</tr>

</table>

<a name="highschoolsports"></a>
<h2>HighSchoolSports.Net</h2>

<p>
Many schools (e.g. <a href="http://www.highschoolsports.net/school/Keene-High-School-Keene-NH">Keene High School</a>) use HighSchoolSports.Net to help manage sports programs. The HighSchoolSports.Net Sync button produces iCalendar feed URLs for individual sports schedules, or for sets of up to 5 schedules (e.g. all basketball teams, including JV and varsity, boys and girls).
</p>

<p>
This helper accepts the name of a high school and a timezone. It produces an iCalendar feed URL that includes <i>all</i> the sports schedules for the named school.
</p>

<table>

<tr>
<td style="text-align:right">School: </td>
<td><input style="width:4in" id="hs_school" value="Keene-High-School-Keene-NH"></td>
</tr>

<tr>
<td style="text-align:right">Timezone: </td>
<td>
<select id="hs_tz">
<option value="ET" selected>ET (Eastern)</option>
<option value="CT">CT (Central)</option>
<option value="MT">MT (Mountain)</option>
<option value="PT">PT (Pacific)</option>
<option value="AT">AT (Alaska)</option>
<option value="HT">HT (Hawaii)</option>
</select>
</td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_hs_ical_url()"></td>
<td></td>
</tr>


</table>

<p>Note: Broken for now. See <a href="http://blog.jonudell.net/2012/09/27/a-great-disturbance-in-the-force/">A great disturbance in the force</a>.</p>


<a name="filters"></a>
<h1>iCalendar filters</h1>

<p>
Sometimes you'll want to use just part of an iCalendar feed. Consider Vinology, a restaurant, wine bar, and jazz venue in Ann Arbor. The <a href="http://www.vinowinebars.net/vinology/enrich_inspirations.php">Vinology calendar</a> contains a mix of restaurant events (e.g. Happy Hour) and jazz events (Doug Horn trio). 
</p>

<p>
As curator of the Ann Arbor hub, you'd prefer that Vinology offered a separate iCalendar feed for the jazz events, so you could include it in the <a href="http://elmcity.cloudapp.net/a2cal/html?view=music,jazz">music and jazz category</a>. Even though Vinology doesn't offer a categorized feed, you can still create one on its behalf. This helper accepts an iCalendar feed URL and various inputs that control the selection of a subset of the feed. It returns a subset of the iCalendar feed.
</p>

<h2>Filtering by keyword</h2>

<p>
One way to produce a jazz feed for Vinology is to restrict the feed to only events containing 'jazz' in the SUMMARY or DESCRIPTION:
</p>

<table>

<tr>
<td style="text-align:right">iCalendar feed URL: </td>
<td><input style="width:5in" id="filter_feed_url" value="http://www.google.com/calendar/ical/vinology110@gmail.com/public/basic.ics"></td>
</tr>

<tr>
<td style="text-align:right">include keyword: </td>
<td><input style="width:1.5in" id="filter_include_keyword" value="jazz"></td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="filter_elmcity_id" value="a2cal"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_ics_to_ics_ical_url_1()"></td>
<td></td>
</tr>

</table>

<p id="ics_to_ics_ical_url_1"></p>

<h2>Filtering by time</h2>

<p>
Another way produce a jazz feed for Vinology is to restrict the feed to only events after 8PM.
</p>

<table>

<tr>
<td style="text-align:right">iCalendar feed URL: </td>
<td><input style="width:5in" id="filter_feed_url2" value="http://www.google.com/calendar/ical/vinology110@gmail.com/public/basic.ics"></td>
</tr>

<tr>
<td style="text-align:right">after: </td>
<td><input style="width:.5in" id="filter_after" value="20:00"> <span style="font-size:smaller">(use 24hr notation)</span></td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" value="a2cal"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_ics_to_ics_ical_url_2()"></td>
<td></td>
</tr>

</table>

<p id="ics_to_ics_ical_url_2"></p>

<h2>Filtering by URL</h2>

<p>
Sometimes a keyword you'd like to filter will on only appear in the URL field of an iCalendar event. Consider the <a href="http://www.bampfa.berkeley.edu/calendar/">Berkeley Art Museum / Pacific Film Archive (BAM/PFA)</a> calendar. It's a mixture of art exhibitions and film showings. The exhibitions can be found using the keyword 'exhibition' but the keyword 'film' does not appear consistently in the SUMMARY or DESCRIPTION fields of the film events. It does, however, appear consistently in the URL field (e.g. http://www.bampfa.berkeley.edu/film/FN19019).
</p>

<p>
Here's how the Berkeley hub uses iCalendar filtering to construct the BAM/PFA film feed that appears in Berkeley's <a href="http://elmcity.cloudapp.net/berkeley/html?view=film">film category</a>:
</p>

<table>

<tr>
<td style="text-align:right">iCalendar feed URL: </td>
<td><input id="bampfa_feed_url" style="width:4in" value="http://press.bampfa.berkeley.edu/calendar/BAM-PFA.ics"></td>
</tr>

<tr>
<td style="text-align:right">include keyword: </td>
<td><input style="width:1.5in" id="url_include" value="film"></td>
</tr>

<tr>
<td style="text-align:right">URL only: </td>
<td>yes</td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="bampfa_elmcity_id" value="berkeley"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_ics_to_ics_ical_url_3()"></td>
<td></td>
</tr>

</table>

<p id="ics_to_ics_ical_url_3"></p>

<h2>Filtering by Location</h2>

<p>
The keyword you'd like to filter might also appear in the LOCATION field of an iCalendar event. Consider <a href="http://b28.cc.trincoll.edu/PublicMasterCalendar/Subscribe.aspx">Trinity College</a>. Its sports schedule lists home and away games, and you can distinguish between them because away games use the word Away in the LOCATION field, like so:
</p>

<pre>
LOCATION:Away Brandeis Univ Rieger Tennis Courts
</pre>

<p>
Here's how the socialhartford hub uses iCalendar filtering to construct feeds for away games:
</p>

<table>

<tr>
<td style="text-align:right">iCalendar feed URL: </td>
<td><input id="trinity_feed_url_away" style="width:4in" value="http://b28.cc.trincoll.edu/PublicMasterCalendar/iCalFeed.aspx?data=f1bM4GJyEC4jIO0bLr4Urg%3d%3d"></td>
</tr>

<tr>
<td style="text-align:right"><i>include keyword</i>: </td>
<td><input style="width:1.5in" id="location_include_away" value="away"></td>
</tr>

<tr>
<td style="text-align:right">LOCATION only: </td>
<td>yes</td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="hartford_elmcity_id_away" value="socialhartford"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_ics_to_ics_ical_url_4()"></td>
<td></td>
</tr>

</table>

<p id="ics_to_ics_ical_url_4"></p>

<p>
And for home games:
</p>

<table>

<tr>
<td style="text-align:right">iCalendar feed URL: </td>
<td><input id="trinity_feed_url_home" style="width:4in" value="http://b28.cc.trincoll.edu/PublicMasterCalendar/iCalFeed.aspx?data=f1bM4GJyEC4jIO0bLr4Urg%3d%3d"></td>
</tr>

<tr>
<td style="text-align:right"><i>exclude keyword</i>: </td>
<td><input style="width:1.5in" id="location_exclude_away" value="away"></td>
</tr>

<tr>
<td style="text-align:right">LOCATION only: </td>
<td>yes</td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="hartford_elmcity_id_home" value="socialhartford"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_ics_to_ics_ical_url_5()"></td>
<td></td>
</tr>

</table>

<p id="ics_to_ics_ical_url_5"></p>

<h3>Filtering by multiple included and/or excluded keywords</h3>

<p>
If you include or exclude a comma-separated list of keywords, they'll OR together. Here's an includer for Crazy Wisdom, in Ann Arbor, that finds events for a Health category. The found events will have health, herbal wisdom, healing, or remedies in the SUMMARY.
</p>

<table>

<tr>
<td style="text-align:right">iCalendar feed URL: </td>
<td><input id="crazy_wisdom_feed_url" style="width:4in" value="http://www.localendar.com/public/crazywisdom?style=X2"></td>
</tr>

<tr>
<td style="text-align:right"><i>include keyword</i>: </td>
<td><input style="width:1.5in" id="include_crazywisdom" value="health,herbal wisdom,healing,remedies"></td>
</tr>

<tr>
<td style="text-align:right">SUMMARY only: </td>
<td>yes</td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="crazy_wisdom_elmcity_id" value="a2cal"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_ics_to_ics_ical_url_6()"></td>
<td></td>
</tr>

</table>

<p id="ics_to_ics_ical_url_6"></p>

<p>
Here's an excluder for Let's Dance Southern Vermont, a feed of dance events with occasional Zumba, Tai Chi, and Yoga events that wouldn't belong in a Dance category.
</p>

<table>

<tr>
<td style="text-align:right">iCalendar feed URL: </td>
<td><input id="lets_dance_feed_url" style="width:4in" value="http://cid-dbad115f7e5abbd4.calendar.live.com/calendar/ray's+calendar/calendar.ics"></td>
</tr>

<tr>
<td style="text-align:right"><i>exclude keyword</i>: </td>
<td><input style="width:1.5in" id="exclude_lets_dance" value="yoga,zumba,tai chi"></td>
</tr>

<tr>
<td style="text-align:right">SUMMARY only: </td>
<td>yes</td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="lets_dance_elmcity_id" value="BrattleboroVT"></td>
</tr>

<tr>
<td><input type="submit" value="get ical url" onclick="get_ics_to_ics_ical_url_7()"></td>
<td></td>
</tr>

</table>

<p id="ics_to_ics_ical_url_7"></p>

<a name="viewers">
<h1>feed viewers</h1>


<a name="feedviewer"></a>
<h2>view feed as raw text</h2>

<p>
This helper accepts a feed URL and shows you the raw contents of the feed. If you specify an iCalendar property (e.g. SUMMARY, DESCRIPTION) it shows you just those properties. Note that if you filter on an optional property that isn't in the feed you'll see nothing. In that case remove the filter and try again.
</p>

<table>

<tr>
<td style="text-align:right">url: </td>
<td><input style="width:8in" id="feedviewer_url" value="http://www.christiansburg.org/common/modules/iCalendar/iCalendar.aspx?catID=25&feed=calendar"></td>
</tr>

<tr>
<td style="text-align:right">property filter: </td>
<td>
<select id="feedviewer_property">
<option value="" selected>none</option>
<option value="SUMMARY">SUMMARY</option>
<option value="DESCRIPTION">DESCRIPTION</option>
<option value="LOCATION">LOCATION</option>
<option value="URL">URL</option>
<option value="CATEGORIES">CATEGORIES</option>
<option value="DTSTART">DTSTART</option>
<option value="DTEND">DTEND</option>
</select>
</td>
</tr>

<tr>
<td><input type="submit" value="view ical feed" onclick="view_feed()"></td>
<td></td>
</tr>

</table>

<a name="calviewer"></a>
<h2>view feed as html</h2>

<p>
This helper accepts a feed URL and an <a href="javascript:ec_id()">Elm City ID</a>. It formats the feed as HTML, so you can check the contents of the feed.
</p>

<table>

<tr>
<td style="text-align:right">url: </td>
<td><input style="width:8in" id="calviewer_url" value="http://monadnockfood.coop/events/ical/"></td>
</tr>

<tr>
<td style="text-align:right"><a href="javascript:ec_id()">Elm City ID</a>: </td>
<td><input style="width:1.5in" id="calviewer_id" value="elmcity"></td>
</tr>

<tr>
<td><input type="submit" value="view feed as html" onclick="view_feed_html()"></td>
<td></td>
</tr>



</table>

<pre>















































































</pre>




</body>
</html>